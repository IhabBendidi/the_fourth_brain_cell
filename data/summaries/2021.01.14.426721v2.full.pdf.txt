We analyzed the pathway composition of the latent space using a global feature importance score, which showed that latent dimensions represent distinct of unseen metabolomics datasets on type  diabetes, schizophrenia, and acute myeloid leukemia and found significant correlations with clinical patient groups
The VAE architecture has, for example, proven effective for predicting cell-level response to infection in transcriptomic data not available during training, and predicting drug response from The application of deep learning architectures to metabolomics datasets has significantly lagged behind all other omics due to the unavailability of large metabolomics cohorts
In addition, the probabilistic structure of VAEs will learn latent dimensions that are generalizable across In this paper, we trained a VAE model on  metabolite measurements in , blood samples from the TwinsUK study and evaluated our model performance in comparison to a linear PCA model (Figure a)
We then applied the models on three additional blood metabolomics datasets to test their ability to recover disease phenotypes in unseen datasets: Type  Diabetes diagnosis in The Qatar Metabolomics Study on Diabetes (QMDiab, n = ), therapy response in an acute myeloid leukemia dataset (AML, n = ), and schizophrenia diagnosis in Figure 
c, QMDiab (n = ), AML (n = ), and Schizophrenia (n = ) datasets were encoded using VAE and PCA models trained on the TwinsUK data
;    a -dimensional input/output layer (the number of metabolites in our datasets), a -We used principal component analysis (PCA) as a baseline model to compare the VAE to a linear latent variable embedding method
To provide insights into the processes represented by different VAE dimensions, we computed SAGE scores, a measure of model feature relevance, at the level of metabolites, sub-pathways and super-pathways (Figure  and Extended Data Figure  for The VAE sub-pathway heatmap (Figure a) shows that nearly all dimensions have major contributions by lipid and amino acid super-pathways
Taken together, these results show that VAE latent dimensions capture a complex mix of functionally-related In contrast, PCA dimensions  to , which by construction represent the highest linear variations in the data, nonspecifically capture various sub-pathways
a, b, c, Sorted -log(p-value) for all VAE and PCA dimensions for the type  diabetes, schizophrenia and AML datasets, respectively
g, h, i, Contributions of super-pathways, sub-pathways and metabolites to the highest scoring VAE latent dimensions, determined by SAGE values
p = p-We investigated whether VAE latent dimensions learned on the TwinsUK data contained information that is generalizable to other datasets
;    from three clinical datasets, type  diabetes, schizophrenia, and acute myeloid leukemia (AML) using the VAE and PCA encoders trained on TwinsUK dataset
Interpretation of VAE latent dimensions at the substantially stronger disease associations than PCA in unseen Type  Diabetes, schizophrenia, and AML datasets
On the mean-centered TwinsUK training set data matrix with n = , samples (rows) and k =  metabolites (which was not certified by peer review) is the author/funder
;    The type  diabetes (QMDiab), schizophrenia, and acute myeloid leukemia (AML) datasets to used in this study are available upon request from the authors and will be shared publicly when the peer-reviewed version of the manuscript is published
Super-pathway and metabolite-level SAGE values for the VAE latent dimensions
Type  Diabetes clinical variable associations with VAE and PCA latent dimensions